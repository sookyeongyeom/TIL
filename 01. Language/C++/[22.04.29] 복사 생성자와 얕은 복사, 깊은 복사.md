# 복사 생성자와 얕은 복사, 깊은 복사

복사생성자를 따로 정의하지 않으면 디폴트 복사 생성자가 붙게 된다.

```cpp
Simple(const Simple& src) : name(src.name), age(src.age) {}
```
디폴트 복사 생성자의 한계점은  
일반변수를 복사할때는 문제가 없지만  
주소값이 복사될때는 하나의 메모리를 두 객체가 동시에 참조하게 된다는 점이다.  
(name을 그냥 src.name으로 초기화하므로 데이터 그 자체가 아닌 주소값이 할당되는 것이다.)  
이런 복사를 얕은 복사라고 부른다.  
따라서 두번째 객체의 소멸자에서 delete[]name 호출 시  
이미 소멸된 메모리에 대해 delete를 시도하여 에러가 발생하게 된다.  

참조하고 있는 대상을 완전히 복사하려면 새로 복사 생성자를 정의하여 깊은 복사를 진행해주어야 한다.  
별거없고 일반변수는 그냥 디폴트 복사 생성자와 마찬가지로 이니셜라이저를 이용해 복사해주고  
문자열 등 배열타입은 일단 필요한 만큼의 새로운 힙 공간을 동적 할당한 다음  
stcpy로 그곳에 배열을 완전히 복사한 후 그 주소를 멤버변수에 할당해주면 된다.  
```cpp
DeepCopy(const DeepCopy& src) : age(src.age)
{
	name = new char[strlen(src.name)+1];
	strcpy(name, src.name);
}
```
